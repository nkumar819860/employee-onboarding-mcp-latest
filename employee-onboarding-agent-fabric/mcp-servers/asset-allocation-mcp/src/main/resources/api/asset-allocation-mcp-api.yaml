openapi: 3.0.3
info:
  title: Asset Allocation MCP Server API
  version: 1.0.2
  description: |
    The Asset Allocation MCP (Model Context Protocol) Server provides intelligent IT asset management capabilities for employee onboarding processes. This API enables automated allocation, tracking, and management of company assets such as laptops, ID cards, and other equipment.

    Key Features:
    - Automated asset allocation during employee onboarding
    - Real-time asset availability tracking  
    - Multi-database support (PostgreSQL, H2, Mock mode)
    - Intelligent fallback strategies for high availability
    - Comprehensive health monitoring and status reporting
    - RESTful API design with JSON responses
  contact:
    name: Asset Allocation MCP Support
    email: support@company.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://asset-allocation-mcp.cloudhub.io/api
    description: Production server
  - url: http://localhost:8082/api
    description: Development server

components:
  schemas:
    Employee:
      type: object
      properties:
        employeeId:
          type: string
          description: Unique employee identifier
        firstName:
          type: string
          description: Employee first name
        lastName:
          type: string
          description: Employee last name
        department:
          type: string
          description: Employee department
        position:
          type: string
          description: Job position/title
      example:
        employeeId: "EMP001"
        firstName: "John"
        lastName: "Doe"
        department: "Engineering"
        position: "Software Developer"

    Asset:
      type: object
      properties:
        assetId:
          type: string
          description: Unique asset identifier
        assetTag:
          type: string
          description: Asset tag/barcode
        assetName:
          type: string
          description: Asset display name
        category:
          type: string
          enum: [LAPTOP, DESKTOP, PHONE, TABLET, ID_CARD, ACCESS_CARD, MONITOR, KEYBOARD, MOUSE, HEADSET]
          description: Asset category
        brand:
          type: string
          description: Asset brand/manufacturer
        model:
          type: string
          description: Asset model
        serialNumber:
          type: string
          description: Serial number
        condition:
          type: string
          enum: [NEW, GOOD, FAIR, POOR, DAMAGED, RETIRED]
          description: Asset condition
        status:
          type: string
          enum: [AVAILABLE, ALLOCATED, MAINTENANCE, RETIRED, LOST]
          description: Asset status
        allocationDate:
          type: string
          format: date-time
          description: Date when asset was allocated
      example:
        assetId: "AST001"
        assetTag: "LAP-001"
        assetName: "Dell Latitude 5520"
        category: "LAPTOP"
        brand: "Dell"
        model: "Latitude 5520"
        serialNumber: "DL123456789"
        condition: "NEW"
        status: "AVAILABLE"

    AllocationRequest:
      type: object
      required:
        - employeeId
      properties:
        employeeId:
          type: string
          description: Employee ID to allocate assets to
        firstName:
          type: string
          description: Employee first name
        lastName:
          type: string
          description: Employee last name
        department:
          type: string
          description: Employee department
        position:
          type: string
          description: Job position
        assets:
          type: array
          items:
            type: string
          description: List of asset types to allocate
          example: ["laptop", "id-card"]
      example:
        employeeId: "EMP001"
        firstName: "John"
        lastName: "Doe"
        department: "Engineering"
        assets: ["laptop", "id-card"]

    AllocationResponse:
      type: object
      properties:
        success:
          type: boolean
          description: Operation success status
        message:
          type: string
          description: Response message
        database:
          type: string
          description: Database used for operation
        employeeId:
          type: string
          description: Employee ID
        employeeName:
          type: string
          description: Employee full name
        allocatedAssets:
          type: array
          items:
            $ref: '#/components/schemas/Asset'
          description: List of allocated assets
        allocationCount:
          type: integer
          description: Number of assets allocated
        timestamp:
          type: string
          format: date-time
          description: Operation timestamp
        mockMode:
          type: boolean
          description: Whether mock mode was used
      example:
        success: true
        message: "Assets allocated successfully"
        database: "h2"
        employeeId: "EMP001"
        employeeName: "John Doe"
        allocatedAssets:
          - assetId: "AST001"
            assetTag: "LAP-001"
            assetName: "Dell Latitude 5520"
            category: "LAPTOP"
            brand: "Dell"
            model: "Latitude 5520"
            serialNumber: "DL123456789"
            condition: "NEW"
            status: "ALLOCATED"
        allocationCount: 1
        timestamp: "2024-01-15T10:30:00Z"
        mockMode: false

    ReturnAssetRequest:
      type: object
      required:
        - assetTag
      properties:
        assetTag:
          type: string
          description: Asset tag to return
        condition:
          type: string
          enum: [NEW, GOOD, FAIR, POOR, DAMAGED]
          description: Asset condition upon return
        notes:
          type: string
          description: Additional notes about the return
      example:
        assetTag: "LAP-001"
        condition: "GOOD"
        notes: "Asset returned in good condition"

    ReturnAssetResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        assetTag:
          type: string
        condition:
          type: string
        returnDate:
          type: string
          format: date-time
        timestamp:
          type: string
          format: date-time

    AssetListResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        database:
          type: string
        assets:
          type: array
          items:
            $ref: '#/components/schemas/Asset'
        assetCount:
          type: integer
        statistics:
          type: object
        timestamp:
          type: string
          format: date-time
        mockMode:
          type: boolean

    AvailableAssetsResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        database:
          type: string
        assets:
          type: array
          items:
            $ref: '#/components/schemas/Asset'
        assetCount:
          type: integer
        categories:
          type: array
          items:
            type: string
        timestamp:
          type: string
          format: date-time

    EmployeeAssetsRequest:
      type: object
      required:
        - employeeId
      properties:
        employeeId:
          type: string
          description: Employee ID to get assets for
      example:
        employeeId: "EMP001"

    EmployeeAssetsResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        database:
          type: string
        employeeId:
          type: string
        assets:
          type: array
          items:
            $ref: '#/components/schemas/Asset'
        assetCount:
          type: integer
        categories:
          type: array
          items:
            type: string
        timestamp:
          type: string
          format: date-time

    HealthStatus:
      type: object
      properties:
        status:
          type: string
          enum: [HEALTHY, DEGRADED, DOWN]
        service:
          type: string
        version:
          type: string
        timestamp:
          type: string
          format: date-time
        environment:
          type: string
        checks:
          type: array
          items:
            type: object
        uptime:
          type: number
        features:
          type: object
      example:
        status: "HEALTHY"
        service: "Asset Allocation MCP Server"
        version: "1.0.2"
        timestamp: "2024-01-15T10:30:00Z"
        environment: "development"
        checks:
          - name: "database"
            status: "UP"
          - name: "application"
            status: "UP"
        uptime: 3600
        features:
          mockMode: false
          databaseRequired: true

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
        message:
          type: string
        timestamp:
          type: string
          format: date-time

paths:
  /health:
    get:
      summary: Health Check
      description: Returns the current health status of the Asset Allocation MCP Server
      operationId: getHealthStatus
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'
        '503':
          description: Service is degraded or unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                status: "DEGRADED"
                message: "Database connection failed"

  /mcp/info:
    get:
      summary: MCP Server Information
      description: Returns detailed information about the MCP server capabilities and available tools
      operationId: getMcpServerInfo
      responses:
        '200':
          description: MCP server information
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  version:
                    type: string
                  description:
                    type: string
                  baseUrl:
                    type: string
                  environment:
                    type: string
                  capabilities:
                    type: object
                  endpoints:
                    type: object
                  tools:
                    type: array
                    items:
                      type: object

  /mcp/tools/allocate-assets:
    post:
      summary: Allocate Assets
      description: |
        Allocates available assets to the specified employee. The system will:
        1. Validate employee information
        2. Find available assets matching the requested types
        3. Update asset status to 'ALLOCATED'
        4. Create allocation records
        5. Return detailed allocation results
      operationId: allocateAssets
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AllocationRequest'
      responses:
        '200':
          description: Assets allocated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AllocationResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                success: false
                error: "INVALID_REQUEST"
                message: "Employee ID is required"
        '404':
          description: No available assets found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /mcp/tools/return-asset:
    post:
      summary: Return Asset
      description: |
        Returns a previously allocated asset to available status. The system will:
        1. Validate asset tag
        2. Update asset status to 'AVAILABLE'
        3. Record return details and condition
        4. Update allocation history
      operationId: returnAsset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReturnAssetRequest'
      responses:
        '200':
          description: Asset returned successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReturnAssetResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Asset not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /mcp/tools/list-assets:
    get:
      summary: List Assets
      description: |
        Returns a paginated list of assets with optional filters:
        - Status filter: AVAILABLE, ALLOCATED, MAINTENANCE, RETIRED
        - Category filter: LAPTOP, ID_CARD, PHONE, etc.
      operationId: listAssets
      parameters:
        - name: status
          in: query
          description: Filter by asset status
          schema:
            type: string
            enum: [AVAILABLE, ALLOCATED, MAINTENANCE, RETIRED, LOST]
        - name: category
          in: query
          description: Filter by asset category
          schema:
            type: string
            enum: [LAPTOP, DESKTOP, PHONE, TABLET, ID_CARD, ACCESS_CARD, MONITOR, KEYBOARD, MOUSE, HEADSET]
      responses:
        '200':
          description: Assets retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AssetListResponse'
        '400':
          description: Invalid query parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /mcp/tools/get-available-assets:
    get:
      summary: Get Available Assets
      description: Returns only assets with 'AVAILABLE' status, ready for allocation to employees
      operationId: getAvailableAssets
      responses:
        '200':
          description: Available assets retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AvailableAssetsResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /mcp/tools/get-employee-assets:
    post:
      summary: Get Employee Assets
      description: Returns all currently allocated assets for the specified employee
      operationId: getEmployeeAssets
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmployeeAssetsRequest'
      responses:
        '200':
          description: Employee assets retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmployeeAssetsResponse'
        '404':
          description: Employee not found or no assets allocated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
